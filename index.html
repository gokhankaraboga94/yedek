<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Türkiye'nin Enleri | Canlı Yarışma</title>
    <style>
        :root { --male: #0084ff; --female: #ff007b; --dark: #1a1a1a; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: #f0f2f5; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* HEADER */
        header { background: var(--dark); color: white; padding: 15px; text-align: center; z-index: 100; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .nav-btns { margin-top: 10px; }
        .btn { padding: 10px 25px; border: none; border-radius: 30px; cursor: pointer; font-weight: bold; color: white; transition: 0.3s; }
        .btn-join { background: #4caf50; font-size: 1rem; }
        .btn-join:hover { background: #45a049; transform: scale(1.05); }

        /* MAIN SPLIT SCREEN */
        .container { display: flex; flex: 1; overflow: hidden; }
        .pane { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px; transition: 0.5s; overflow-y: auto; }
        .pane-male { background: #e3f2fd; border-right: 3px solid #ccc; }
        .pane-female { background: #fff0f6; }
        
        .pane h2 { margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; }
        .pane-male h2 { color: var(--male); }
        .pane-female h2 { color: var(--female); }

        /* MAP DESIGN */
        .map-box { width: 100%; max-width: 650px; position: relative; }
        svg { width: 100%; height: auto; filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.1)); }
        path { fill: #fff; stroke: #888; stroke-width: 0.5; transition: 0.2s; cursor: pointer; }
        .pane-male path:hover { fill: var(--male); }
        .pane-female path:hover { fill: var(--female); }
        .city-label { font-size: 8px; font-weight: bold; pointer-events: none; fill: #444; }

        /* MODALS */
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); display:none; justify-content:center; align-items:center; z-index:1000; padding:15px; }
        .modal-content { background:white; padding:25px; border-radius:15px; width:100%; max-width:450px; position:relative; }
        .modal-close { position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer; color:#666; }
        
        input, select { width:100%; padding:12px; margin:10px 0; border:1px solid #ddd; border-radius:8px; }
        
        /* CANDIDATE LIST */
        .candidate-card { display: flex; align-items: center; background: #f8f9fa; padding: 15px; border-radius: 12px; margin-bottom: 10px; border: 1px solid #eee; }
        .candidate-img { width: 70px; height: 70px; border-radius: 50%; object-fit: cover; margin-right: 15px; border: 3px solid #ddd; }
        .vote-count { margin-left: auto; font-weight: bold; font-size: 1.2rem; color: #333; }
        .vote-btn { background: #ff9800; padding: 8px 15px; border-radius: 5px; margin-left: 10px; }

        /* MOBILE TABS */
        .mobile-nav { display: none; background: white; border-top: 1px solid #ddd; }
        .tab-item { flex: 1; padding: 15px; text-align: center; font-weight: bold; cursor: pointer; }

        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .pane { display: none; }
            .pane.active { display: flex; }
            .mobile-nav { display: flex; }
        }
    </style>
</head>
<body>

<header>
    <h1>TÜRKİYE'NİN ENLERİ</h1>
    <div class="nav-btns">
        <button class="btn btn-join" onclick="openModal('uploadModal')">Yarışmacı Ol (Anında Yayınla)</button>
    </div>
</header>

<div class="container">
    <div class="pane pane-male active" id="paneMale">
        <h2>ERKEKLER HARİTASI</h2>
        <div class="map-box" id="mapMale"></div>
    </div>

    <div class="pane pane-female" id="paneFemale">
        <h2>KADINLAR HARİTASI</h2>
        <div class="map-box" id="mapFemale"></div>
    </div>
</div>

<div class="mobile-nav">
    <div class="tab-item" style="color:var(--male)" onclick="switchMobile('male')">Erkekler</div>
    <div class="tab-item" style="color:var(--female)" onclick="switchMobile('female')">Kadınlar</div>
</div>

<div id="uploadModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal('uploadModal')">&times;</span>
        <h3>Yeni Aday Ekle</h3>
        <p style="font-size:0.8rem; color:red;">* Moderasyon kapalı: Fotoğrafın anında yayına alınacaktır.</p>
        <select id="upGender">
            <option value="male">Erkek</option>
            <option value="female">Kadın</option>
        </select>
        <input type="number" id="upCity" placeholder="Şehir Plaka Kodu (1-81)" min="1" max="81">
        <input type="text" id="upName" placeholder="Adın (Görünecek isim)">
        <input type="file" id="upFile" accept="image/*">
        <button class="btn" style="background:var(--male); width:100%;" onclick="submitAday()">Yayına Al</button>
    </div>
</div>

<div id="voteModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <span class="modal-close" onclick="closeModal('voteModal')">&times;</span>
        <h3 id="voteTitle">Şehir Adayları</h3>
        <div id="candidateList" style="margin-top:20px; max-height:400px; overflow-y:auto;">
            </div>
    </div>
</div>

<script>
    // 81 İL VERİSİ (BASİTLEŞTİRİLMİŞ SVG)
    // Gökhan, burada 81 ilin path verilerini bir JSON'dan veya API'den çekmek en iyisidir.
    // Prototip için ana harita iskeletini oluşturuyoruz.
    const cityList = ["Adana","Adıyaman","Afyon","Ağrı","Amasya","Ankara","Antalya","Artvin","Aydın","Balıkesir","Bilecik","Bingöl","Bitlis","Bolu","Burdur","Bursa","Çanakkale","Çankırı","Çorum","Denizli","Diyarbakır","Edirne","Elazığ","Erzincan","Erzurum","Eskişehir","Gaziantep","Giresun","Gümüşhane","Hakkari","Hatay","Isparta","Mersin","İstanbul","İzmir","Kars","Kastamonu","Kayseri","Kırklareli","Kırşehir","Kocaeli","Konya","Kütahya","Malatya","Manisa","Kahramanmaraş","Mardin","Muğla","Muş","Nevşehir","Niğde","Ordu","Rize","Sakarya","Samsun","Siirt","Sinop","Sivas","Tekirdağ","Tokat","Trabzon","Tunceli","Şanlıurfa","Uşak","Van","Yozgat","Zonguldak","Aksaray","Bayburt","Karaman","Kırıkkale","Batman","Şırnak","Bartın","Ardahan","Iğdır","Yalova","Karabük","Kilis","Osmaniye","Düzce"];

    // Veri Deposu (LocalStorage)
    let adaylar = JSON.parse(localStorage.getItem('adaylar')) || [];

    // Haritaları Çiz
    function drawMaps() {
        const svgContent = `<svg viewBox="0 0 1000 450">${cityList.map((city, i) => `
            <path id="city-${i+1}" d="M${100+(i%10)*80},${50+Math.floor(i/10)*50} l60,0 l0,40 l-60,0 z" class="city" onclick="openCity('${i+1}')" />
            <text x="${110+(i%10)*80}" y="${75+Math.floor(i/10)*50}" class="city-label">${i+1}</text>
        `).join('')}</svg>`;
        
        // Not: Gerçek koordinatları path içine yerleştirmelisin. Bu bir grid temsilidir.
        document.getElementById('mapMale').innerHTML = svgContent;
        document.getElementById('mapFemale').innerHTML = svgContent;
    }

    // Aday Yükleme (Moderasyonsuz)
    function submitAday() {
        const gender = document.getElementById('upGender').value;
        const city = document.getElementById('upCity').value;
        const name = document.getElementById('upName').value;
        const file = document.getElementById('upFile').files[0];

        if(!city || !name || !file) return alert("Boş alan bırakma!");

        const reader = new FileReader();
        reader.onload = function(e) {
            const newAday = {
                id: Date.now(),
                gender,
                city,
                name,
                img: e.target.result,
                votes: 0
            };
            adaylar.push(newAday);
            localStorage.setItem('adaylar', JSON.stringify(adaylar));
            alert("Harika! Adaylığın anında onaylandı.");
            closeModal('uploadModal');
        };
        reader.readAsDataURL(file);
    }

    // Şehir Detay ve Oylama
    function openCity(cityId) {
        // Hangi panele tıklandığını bul
        const activePane = document.querySelector('.pane.active') || document.querySelector('.pane:hover');
        const gender = activePane.id.includes('Male') ? 'male' : 'female';
        
        const cityAdaylari = adaylar.filter(a => a.city == cityId && a.gender == gender)
                                    .sort((a,b) => b.votes - a.votes);

        const listDiv = document.getElementById('candidateList');
        document.getElementById('voteTitle').innerText = `${cityId} Plakalı Şehir - ${gender == 'male' ? 'Erkekler' : 'Kadınlar'}`;
        
        if(cityAdaylari.length === 0) {
            listDiv.innerHTML = "<p>Henüz aday yok. İlk sen ol!</p>";
        } else {
            listDiv.innerHTML = cityAdaylari.map(a => `
                <div class="candidate-card">
                    <img src="${a.img}" class="candidate-img">
                    <div><strong>${a.name}</strong></div>
                    <div class="vote-count">${a.votes} Oy</div>
                    <button class="btn vote-btn" onclick="vote(${a.id})">Oy Ver</button>
                </div>
            `).join('');
        }
        openModal('voteModal');
    }

    function vote(id) {
        const hasVoted = localStorage.getItem('voted_' + id);
        if(hasVoted) return alert("Bu adaya zaten oy verdin!");

        const index = adaylar.findIndex(a => a.id === id);
        adaylar[index].votes++;
        localStorage.setItem('adaylar', JSON.stringify(adaylar));
        localStorage.setItem('voted_' + id, 'true');
        
        alert("Oyun kaydedildi!");
        closeModal('voteModal');
    }

    // Modal Kontrolleri
    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function switchMobile(g) {
        document.getElementById('paneMale').classList.toggle('active', g === 'male');
        document.getElementById('paneFemale').classList.toggle('active', g === 'female');
    }

    window.onload = drawMaps;
</script>

</body>
</html>
